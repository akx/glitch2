!function t(e,i,r){function s(n,a){if(!i[n]){if(!e[n]){var h="function"==typeof require&&require;if(!a&&h)return h(n,!0);if(o)return o(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[n]={exports:{}};e[n][0].call(u.exports,(function(t){return s(e[n][1][t]||t)}),u,u.exports,t,e,i,r)}return i[n].exports}for(var o="function"==typeof require&&require,n=0;n<r.length;n++)s(r[n]);return s}({1:[function(t,e,i){var r=t("./TypedNeuQuant.js"),s=t("./LZWEncoder.js");function o(){this.page=-1,this.pages=[],this.newPage()}o.pageSize=4096,o.charMap={};for(var n=0;n<256;n++)o.charMap[n]=String.fromCharCode(n);function a(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new o}o.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(o.pageSize),this.cursor=0},o.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var i=0;i<o.pageSize;i++)t+=o.charMap[this.pages[e][i]];return t},o.prototype.writeByte=function(t){this.cursor>=o.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},o.prototype.writeUTFBytes=function(t){for(var e=t.length,i=0;i<e;i++)this.writeByte(t.charCodeAt(i))},o.prototype.writeBytes=function(t,e,i){for(var r=i||t.length,s=e||0;s<r;s++)this.writeByte(t[s])},a.prototype.setDelay=function(t){this.delay=Math.round(t/10)},a.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},a.prototype.setDispose=function(t){t>=0&&(this.dispose=t)},a.prototype.setRepeat=function(t){this.repeat=t},a.prototype.setTransparent=function(t){this.transparent=t},a.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},a.prototype.finish=function(){this.out.writeByte(59)},a.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},a.prototype.setDither=function(t){!0===t&&(t="FloydSteinberg"),this.dither=t},a.prototype.setGlobalPalette=function(t){this.globalPalette=t},a.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},a.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},a.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new r(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},a.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var i=0,r=0;r<e;r++){var s=this.findClosestRGB(255&this.pixels[i++],255&this.pixels[i++],255&this.pixels[i++]);this.usedEntry[s]=!0,this.indexedPixels[r]=s}},a.prototype.ditherPixels=function(t,e){var i={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!t||!i[t])throw"Unknown dithering kernel: "+t;var r=i[t],s=0,o=this.height,n=this.width,a=this.pixels,h=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var l=0;l<o;l++){e&&(h*=-1);for(var u=1==h?0:n-1,p=1==h?n:0;u!==p;u+=h){var f=3*(s=l*n+u),c=a[f],y=a[f+1],w=a[f+2];f=this.findClosestRGB(c,y,w),this.usedEntry[f]=!0,this.indexedPixels[s]=f,f*=3;for(var d=c-this.colorTab[f],g=y-this.colorTab[f+1],x=w-this.colorTab[f+2],b=1==h?0:r.length-1,v=1==h?r.length:0;b!==v;b+=h){var P=r[b][1],m=r[b][2];if(P+u>=0&&P+u<n&&m+l>=0&&m+l<o){var B=r[b][0];f=s+P+m*n,a[f*=3]=Math.max(0,Math.min(255,a[f]+d*B)),a[f+1]=Math.max(0,Math.min(255,a[f+1]+g*B)),a[f+2]=Math.max(0,Math.min(255,a[f+2]+x*B))}}}}},a.prototype.findClosest=function(t,e){return this.findClosestRGB((16711680&t)>>16,(65280&t)>>8,255&t,e)},a.prototype.findClosestRGB=function(t,e,i,r){if(null===this.colorTab)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,i);for(var s=0,o=16777216,n=this.colorTab.length,a=0,h=0;a<n;h++){var l=t-(255&this.colorTab[a++]),u=e-(255&this.colorTab[a++]),p=i-(255&this.colorTab[a++]),f=l*l+u*u+p*p;(!r||this.usedEntry[h])&&f<o&&(o=f,s=h)}return s},a.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var i=this.image,r=0,s=0,o=0;o<e;o++)for(var n=0;n<t;n++)this.pixels[s++]=i[r++],this.pixels[s++]=i[r++],this.pixels[s++]=i[r++],r++},a.prototype.writeGraphicCtrlExt=function(){var t,e;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=7&dispose),e<<=2,this.out.writeByte(e|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},a.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},a.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},a.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},a.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)},a.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},a.prototype.writePixels=function(){new s(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this.out)},a.prototype.stream=function(){return this.out},e.exports=a},{"./LZWEncoder.js":2,"./TypedNeuQuant.js":3}],2:[function(t,e,i){var r=5003,s=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.exports=function(t,e,i,o){var n,a,h,l,u,p,f=Math.max(2,o),c=new Uint8Array(256),y=new Int32Array(r),w=new Int32Array(r),d=0,g=0,x=!1;function b(t,e){c[a++]=t,a>=254&&m(e)}function v(t){P(r),g=u+2,x=!0,T(u,t)}function P(t){for(var e=0;e<t;++e)y[e]=-1}function m(t){a>0&&(t.writeByte(a),t.writeBytes(c,0,a),a=0)}function B(t){return(1<<t)-1}function S(){return 0===remaining?-1:(--remaining,255&i[curPixel++])}function T(t,e){for(n&=s[d],d>0?n|=t<<d:n=t,d+=n_bits;d>=8;)b(255&n,e),n>>=8,d-=8;if((g>h||x)&&(x?(h=B(n_bits=l),x=!1):(++n_bits,h=12==n_bits?4096:B(n_bits))),t==p){for(;d>0;)b(255&n,e),n>>=8,d-=8;m(e)}}this.encode=function(i){i.writeByte(f),remaining=t*e,curPixel=0,function(t,e){var i,s,o,n,f,c,d;for(l=t,x=!1,n_bits=l,h=B(n_bits),p=1+(u=1<<t-1),g=u+2,a=0,n=S(),d=0,i=r;i<65536;i*=2)++d;d=8-d,P(c=r),T(u,e);t:for(;-1!=(s=S());)if(i=(s<<12)+n,y[o=s<<d^n]!==i){if(y[o]>=0){f=c-o,0===o&&(f=1);do{if((o-=f)<0&&(o+=c),y[o]===i){n=w[o];continue t}}while(y[o]>=0)}T(n,e),n=s,g<4096?(w[o]=g++,y[o]=i):v(e)}else n=w[o];T(n,e),T(p,e)}(f+1,i),i.writeByte(0)}}},{}],3:[function(t,e,i){var r=256,s=1024,o=1<<18;e.exports=function(t,e){var i,n,a,h,l;function u(t,e,r,o,n){i[e][0]-=t*(i[e][0]-r)/s,i[e][1]-=t*(i[e][1]-o)/s,i[e][2]-=t*(i[e][2]-n)/s}function p(t,e,s,n,a){for(var h,u,p=Math.abs(e-t),f=Math.min(e+t,r),c=e+1,y=e-1,w=1;c<f||y>p;)u=l[w++],c<f&&((h=i[c++])[0]-=u*(h[0]-s)/o,h[1]-=u*(h[1]-n)/o,h[2]-=u*(h[2]-a)/o),y>p&&((h=i[y--])[0]-=u*(h[0]-s)/o,h[1]-=u*(h[1]-n)/o,h[2]-=u*(h[2]-a)/o)}function f(t,e,s){var o,n,l,u,p,f=~(1<<31),c=f,y=-1,w=y;for(o=0;o<r;o++)n=i[o],(l=Math.abs(n[0]-t)+Math.abs(n[1]-e)+Math.abs(n[2]-s))<f&&(f=l,y=o),(u=l-(a[o]>>12))<c&&(c=u,w=o),p=h[o]>>10,h[o]-=p,a[o]+=p<<10;return h[y]+=64,a[y]-=65536,w}this.buildColormap=function(){!function(){var t,e;for(i=[],n=new Int32Array(256),a=new Int32Array(r),h=new Int32Array(r),l=new Int32Array(32),t=0;t<r;t++)e=(t<<12)/r,i[t]=new Float64Array([e,e,e,0]),h[t]=256,a[t]=0}(),function(){var i,r,o,n,a,h,c=t.length,y=30+(e-1)/3,w=c/(3*e),d=~~(w/100),g=s,x=2048,b=x>>6;for(b<=1&&(b=0),i=0;i<b;i++)l[i]=g*(256*(b*b-i*i)/(b*b));c<1509?(e=1,r=3):r=c%499!=0?1497:c%491!=0?1473:c%487!=0?1461:1509;var v=0;for(i=0;i<w;)if(u(g,h=f(o=(255&t[v])<<4,n=(255&t[v+1])<<4,a=(255&t[v+2])<<4),o,n,a),0!==b&&p(b,h,o,n,a),(v+=r)>=c&&(v-=c),0===d&&(d=1),++i%d==0)for(g-=g/y,(b=(x-=x/30)>>6)<=1&&(b=0),h=0;h<b;h++)l[h]=g*(256*(b*b-h*h)/(b*b))}(),function(){for(var t=0;t<r;t++)i[t][0]>>=4,i[t][1]>>=4,i[t][2]>>=4,i[t][3]=t}(),function(){var t,e,s,o,a,h,l=0,u=0;for(t=0;t<r;t++){for(a=t,h=(s=i[t])[1],e=t+1;e<r;e++)(o=i[e])[1]<h&&(a=e,h=o[1]);if(o=i[a],t!=a&&(e=o[0],o[0]=s[0],s[0]=e,e=o[1],o[1]=s[1],s[1]=e,e=o[2],o[2]=s[2],s[2]=e,e=o[3],o[3]=s[3],s[3]=e),h!=l){for(n[l]=u+t>>1,e=l+1;e<h;e++)n[e]=t;l=h,u=t}}for(n[l]=u+255>>1,e=l+1;e<256;e++)n[e]=255}()},this.getColormap=function(){for(var t=[],e=[],s=0;s<r;s++)e[i[s][3]]=s;for(var o=0,n=0;n<r;n++){var a=e[n];t[o++]=i[a][0],t[o++]=i[a][1],t[o++]=i[a][2]}return t},this.lookupRGB=function(t,e,s){for(var o,a,h,l=1e3,u=-1,p=n[e],f=p-1;p<r||f>=0;)p<r&&((h=(a=i[p])[1]-e)>=l?p=r:(p++,h<0&&(h=-h),(o=a[0]-t)<0&&(o=-o),(h+=o)<l&&((o=a[2]-s)<0&&(o=-o),(h+=o)<l&&(l=h,u=a[3])))),f>=0&&((h=e-(a=i[f])[1])>=l?f=-1:(f--,h<0&&(h=-h),(o=a[0]-t)<0&&(o=-o),(h+=o)<l&&((o=a[2]-s)<0&&(o=-o),(h+=o)<l&&(l=h,u=a[3]))));return u}}},{}],4:[function(t,e,i){var r,s;r=t("./GIFEncoder.js"),s=function(t){var e,i,s,o;return e=new r(t.width,t.height),0===t.index?e.writeHeader():e.firstFrame=!1,e.setTransparent(t.transparent),e.setRepeat(t.repeat),e.setDelay(t.delay),e.setQuality(t.quality),e.setDither(t.dither),e.setGlobalPalette(t.globalPalette),e.addFrame(t.data),t.last&&e.finish(),!0===t.globalPalette&&(t.globalPalette=e.getGlobalPalette()),s=e.stream(),t.data=s.pages,t.cursor=s.cursor,t.pageSize=s.constructor.pageSize,t.canTransfer?(o=function(){var e,r,s,o;for(o=[],e=0,r=(s=t.data).length;e<r;e++)i=s[e],o.push(i.buffer);return o}(),self.postMessage(t,o)):self.postMessage(t)},self.onmessage=function(t){return s(t.data)}},{"./GIFEncoder.js":1}]},{},[4]);